"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3905],{3905:(F,U,a)=>{a.r(U),a.d(U,{NewUserModule:()=>A});var w=a(177),C=a(5260),N=a(467),d=a(4341),D=a(1413),e=a(3953),i=a(4742),k=a(7373),M=a(7777),S=a(4280),j=a(2765),E=a(874);function R(t,l){if(1&t&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-subtitle"),e.EFF(3),e.k0s(),e.j41(4,"ion-card-title"),e.EFF(5," WELCOME "),e.k0s()(),e.nrm(6,"ion-card-content"),e.k0s()),2&t){const r=e.XpG();e.R7$(3),e.SpI(" ",r.userData.email," ")}}function P(t,l){if(1&t&&(e.j41(0,"div",10),e.EFF(1),e.k0s()),2&t){const r=e.XpG();e.R7$(),e.Lme(" ",r.placeData.address.state_district,",",r.placeData.address.state," ")}}function I(t,l){1&t&&(e.j41(0,"ion-item",15),e.nrm(1,"ion-input",16),e.k0s())}function G(t,l){1&t&&(e.j41(0,"ion-item",15),e.nrm(1,"ion-input",17),e.k0s())}function T(t,l){1&t&&(e.j41(0,"ion-item",15),e.nrm(1,"ion-input",18),e.k0s())}function O(t,l){1&t&&(e.j41(0,"ion-item",15)(1,"ion-segment",19)(2,"ion-segment-button",20),e.nrm(3,"ion-icon",21),e.j41(4,"ion-label"),e.EFF(5,"Home"),e.k0s()(),e.j41(6,"ion-segment-button",22),e.nrm(7,"ion-icon",23),e.j41(8,"ion-label"),e.EFF(9,"Office"),e.k0s()(),e.j41(10,"ion-segment-button",24),e.nrm(11,"ion-icon",25),e.j41(12,"ion-label"),e.EFF(13,"Other"),e.k0s()()()())}function X(t,l){if(1&t&&e.DNE(0,I,2,0,"ion-item",14)(1,G,2,0,"ion-item",14)(2,T,2,0,"ion-item",14)(3,O,14,0,"ion-item",14),2&t){const r=e.XpG();e.Y8G("ngIf",r.coordinates),e.R7$(),e.Y8G("ngIf",r.coordinates),e.R7$(),e.Y8G("ngIf",r.coordinates),e.R7$(),e.Y8G("ngIf",r.coordinates)}}const x=[{path:"",component:(()=>{var t;class l{constructor(n,o,s,v,c,u,m,p,g,f){this.formBuilder=n,this.loadingCtrl=o,this.dbService=s,this.router=v,this.userService=c,this.route=u,this.storageService=m,this.uuidService=p,this.loadingController=g,this.toastController=f,this.showPopup=!1,this.searchInput="",this.dropdownOptions=[],this.selectedPlace={latitude:0,longitude:0},this.locationRegistered=!1,this.searchSubject=new D.B,this.mode="new",this.coordinates=null,this.userEmail="",this.isDataInvalid=!1,this.registrationForm=this.formBuilder.group({mobileNumber:["",d.k0.compose([d.k0.required])],address:["",d.k0.required],pincode:[""],landmark:[""],tag:["home"]})}ngOnInit(){this.dbService.getUserData().then(o=>{o&&(console.log(o),this.userData=o)}),this.storageService.get("coordinates").then(o=>{this.userEmail=o}),this.storageService.get("coordinates").then(o=>{var s,v;o&&(this.coordinates=JSON.parse(o),console.log("coordinates:--\x3e"+this.coordinates),this.coordinates&&this.userService.getPlaceName(null===(s=this.coordinates)||void 0===s?void 0:s.lat,null===(v=this.coordinates)||void 0===v?void 0:v.lng).subscribe(c=>{if(c){this.placeData=c;try{this.registrationForm.patchValue({pincode:this.placeData.address.postcode})}catch(u){console.log(u)}}}))});try{var n;let o=null===(n=this.route)||void 0===n||null===(n=n.snapshot)||void 0===n||null===(n=n.paramMap)||void 0===n?void 0:n.get("mode");o&&(this.mode=o)}catch(o){console.log(o)}this.route.queryParams.subscribe(o=>{try{this.registrationForm.setValue({mobileNumber:o.mobileNumber||"",address:o.address||"",pincode:o.pincode||"",landmark:o.landmark||"",tag:o.tag||""})}catch(s){console.log(s)}})}ionViewWillEnter(){this.storageService.get("coordinates").then(n=>{n&&(this.coordinates=JSON.parse(n),console.log("coordinates:--\x3e"+this.coordinates))})}registerUser(){var n=this;return(0,N.A)(function*(){var o;if(!n.registrationForm.valid)return;const s=yield n.loadingController.create({message:"Registering user..."});yield s.present();const v=null===(o=n.registrationForm)||void 0===o||null===(o=o.get("mobileNumber"))||void 0===o?void 0:o.value;if(n.coordinates&&n.userData.displayName&&n.userData.email&&n.userData.photoUrl&&n.userData.uid){var c,u,m,p,g;let f={user_address_id:n.uuidService.generateSecureUuid(),user_phone:v,default:!0,user_coordinates:n.coordinates,user_address:null===(c=n.registrationForm)||void 0===c||null===(c=c.get("address"))||void 0===c?void 0:c.value,user_pincode:null===(u=n.registrationForm)||void 0===u||null===(u=u.get("pincode"))||void 0===u?void 0:u.value,user_nearby_landmark:null===(m=n.registrationForm)||void 0===m||null===(m=m.get("landmark"))||void 0===m?void 0:m.value,user_address_tag:null===(p=n.registrationForm)||void 0===p||null===(p=p.get("tag"))||void 0===p?void 0:p.value},y={user_name:n.userData.displayName,user_address:[f],user_email:n.userData.email,user_phone:null===(g=n.registrationForm)||void 0===g||null===(g=g.get("mobileNumber"))||void 0===g?void 0:g.value,user_image:n.userData.photoUrl,user_id:n.userData.uid,user_type:"USER"};console.log(y),"add"==n.mode?n.userService.addNewUserAddres(f,n.userData.uid).subscribe(h=>{s.dismiss().then(b=>{n.router.navigate(["/home/settings/manage-address"])})}):"update"==n.mode?n.userService.updateUserAddres(f,n.userData.uid).subscribe(function(){var h=(0,N.A)(function*(b){s.dismiss().then(B=>{n.router.navigate(["/home/settings/manage-address"])}),console.log(b)});return function(b){return h.apply(this,arguments)}}()):n.dbService.RegisterUser(y).subscribe(h=>{console.log(h),null==h?s.dismiss().then(b=>{n.toastController.presentToast("Something went wrong. Please try again!","warning")}):s.dismiss().then(b=>{n.router.navigate(["/home"])})})}else console.log("invalid data"),n.registrationForm.disable({onlySelf:!0}),n.isDataInvalid=!0,n.toastController.presentToast("Invalid Data. Please try again!","warning")})()}presentErrorToast(n){var o=this;return(0,N.A)(function*(){o.toastController.presentToast(n,"danger")})()}openMaps(){this.router.navigate(["/register/open-map/"+this.mode])}showLoading(){var n=this;return(0,N.A)(function*(){(yield n.loadingCtrl.create({message:"Loading Current location",duration:4e3})).present()})()}onKeyUp(n){console.log(n),this.searchSubject.next(n.target.value),this.showPopup=!0}onhistoryDismiss(n){}navigatetoLogin(){this.router.navigate(["/login"])}}return(t=l).\u0275fac=function(n){return new(n||t)(e.rXU(d.ok),e.rXU(i.Xi),e.rXU(k.q),e.rXU(C.Ix),e.rXU(M.D),e.rXU(C.nX),e.rXU(S.s),e.rXU(j.j),e.rXU(i.Xi),e.rXU(E.Z))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-new-user"]],decls:19,vars:10,consts:[[1,"ion-padding"],[1,"register-container"],[1,"title-content"],[1,"welcome-block"],["src","../../../assets/logo.png",1,"hg_logo"],[3,"formGroup"],["label","Mobile number","labelPlacement","stacked","formControlName","mobileNumber","required","","placeholder","Enter a valid 10 digit mobile number"],[1,"place-block"],["fill","clear","color","danger",3,"click"],["slot","start",3,"name"],[1,"place-info"],[1,"action-block"],["expand","full",3,"click","disabled"],["message","Something went wrong.. Please try again.",3,"didDismiss","isOpen","duration"],["color","light",4,"ngIf"],["color","light"],["label","Address","labelPlacement","stacked","formControlName","address"],["label","Pincode","labelPlacement","stacked","type","number","formControlName","pincode"],["label","Landmark","labelPlacement","stacked","formControlName","landmark"],["value","home","formControlName","tag","color","primary"],["value","home"],["name","home"],["value","office"],["name","briefcase-outline"],["value","other"],["name","pin-outline"]],template:function(n,o){1&n&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3),e.nrm(4,"img",4),e.k0s()(),e.DNE(5,R,7,1,"ion-card"),e.j41(6,"form",5)(7,"ion-item"),e.nrm(8,"ion-input",6),e.k0s(),e.j41(9,"div",7)(10,"ion-button",8),e.bIt("click",function(){return o.openMaps()}),e.nrm(11,"ion-icon",9),e.EFF(12),e.k0s(),e.DNE(13,P,2,2,"div",10),e.k0s(),e.DNE(14,X,4,4),e.j41(15,"div",11)(16,"ion-button",12),e.bIt("click",function(){return o.registerUser()}),e.EFF(17),e.k0s()()()(),e.j41(18,"ion-toast",13),e.bIt("didDismiss",function(){return o.navigatetoLogin()}),e.k0s()()),2&n&&(e.R7$(5),e.vxM(o.userEmail?5:-1),e.R7$(),e.Y8G("formGroup",o.registrationForm),e.R7$(5),e.Y8G("name",o.coordinates?"pin-outline":"locate-outline"),e.R7$(),e.SpI(" ",o.coordinates?"Edit location":"Select your location"," "),e.R7$(),e.vxM(o.coordinates&&o.placeData?13:-1),e.R7$(),e.vxM(o.coordinates?14:-1),e.R7$(2),e.Y8G("disabled",!o.registrationForm.valid),e.R7$(),e.SpI(" ","Register"," "),e.R7$(),e.Y8G("isOpen",o.isDataInvalid)("duration",5e3))},dependencies:[d.qT,d.BC,d.cb,d.YS,d.j4,d.JD,i.Jm,i.b_,i.I9,i.ME,i.HW,i.tN,i.W9,i.iq,i.$w,i.uz,i.he,i.Gp,i.eP,i.op,i.su,i.Je,i.Gw,w.bT],styles:[".main-form-container[_ngcontent-%COMP%]{height:100%;display:flex;align-content:space-between;flex-direction:column;justify-content:space-between}.notification-container[_ngcontent-%COMP%]{background-color:#e8eaf6;border-radius:.2rem;margin:1rem;padding:1rem}.notification-block[_ngcontent-%COMP%]{background:#ef5350;padding:.2rem;border-radius:.2rem;color:#fff;height:2rem}.hg_logo[_ngcontent-%COMP%]{aspect-ratio:1/1;height:5rem;border-radius:.3rem}.welcome-block[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.title-content[_ngcontent-%COMP%]{margin-top:5vh}.register-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.place-block[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:.5rem}"]}),l})(),pathMatch:"full"},{path:"open-map/:mode",loadComponent:()=>a.e(6965).then(a.bind(a,6965)).then(t=>t.MapViewComponent)}];let Y=(()=>{var t;class l{}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[C.iI.forChild(x),C.iI]}),l})(),A=(()=>{var t;class l{}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[d.YN,d.X1,i.bv,w.MD,Y]}),l})()}}]);